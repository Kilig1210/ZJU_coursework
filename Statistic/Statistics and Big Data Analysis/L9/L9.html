
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>拟合优度 &#8212; 统计与大数据分析</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint single-page" id="site-navigation">
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/L9.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/L9.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   拟合优度
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   分类数据的理论检验
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#p-value">
   p-value
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   拟合优度例子
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   理论含有未知参数
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contingency-table">
   对列联表（Contingency Table）
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   对列联表例1
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   对列联表例2
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>拟合优度</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   拟合优度
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   分类数据的理论检验
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#p-value">
   p-value
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   拟合优度例子
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   理论含有未知参数
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contingency-table">
   对列联表（Contingency Table）
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id5">
   对列联表例1
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id6">
   对列联表例2
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <center>
<h1> 统计与大数据分析</h1>
<h2> 拟合优度</h2>
<h5>肖朦</h5>
</center><section id="id1">
<h1>拟合优度<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>若有一组观察数据，想检验它和理论预言是否相符，如何检测？</p></li>
</ul>
</section>
<section id="id2">
<h1>分类数据的理论检验<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>假设<span class="math notranslate nohighlight">\(H_0：P(X=a_i) = p_i, i=1\cdots k\)</span></p></li>
<li><p>若对X进行n次观测，得到样本<span class="math notranslate nohighlight">\(x_1,\cdots,x_n\)</span>，<span class="math notranslate nohighlight">\(x=a_i\)</span>的次数记为<span class="math notranslate nohighlight">\(\nu_i\)</span></p></li>
</ul>
<p>检验<span class="math notranslate nohighlight">\(H_0\)</span>是否成立</p>
<ul class="simple">
<li><p>理论预言：第i个值的个数为 <span class="math notranslate nohighlight">\(np_i\)</span></p></li>
<li><p>实际测量：第i个值的个数为 <span class="math notranslate nohighlight">\(\nu_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(|np_i - \nu_i|\)</span>应该尽可能小</p></li>
</ul>
<p>定义</p>
<div class="math notranslate nohighlight">
\[ Z= \sum_{i=1}^{k} (np_i - \nu_i)^2/(np_i)\]</div>
<ul class="simple">
<li><p>Z符合什么分布？</p></li>
<li><p>在一定情况下，<span class="math notranslate nohighlight">\(\nu_i\)</span>符合泊松分布</p></li>
<li><p><span class="math notranslate nohighlight">\((np_i - \nu_i)/\sqrt{np_i} \)</span>符合正态分布</p></li>
<li><p>Z符合<span class="math notranslate nohighlight">\(\chi^2\)</span>分布，自由度？</p>
<ul>
<li><p>k-1</p></li>
</ul>
</li>
<li><p>Z:皮尔逊的拟合优度<span class="math notranslate nohighlight">\(\chi^2\)</span>统计量（Pearson’s chi-squared test）</p></li>
</ul>
</section>
<section id="p-value">
<h1>p-value<a class="headerlink" href="#p-value" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Z越大，理论与实验越不符,</p></li>
<li><p>最佳值<span class="math notranslate nohighlight">\(\approx\)</span> k-1, 常常用<span class="math notranslate nohighlight">\(Z/(k-1)\)</span>表示与理论的符合度，最佳值<span class="math notranslate nohighlight">\(\approx\)</span>1</p></li>
<li><p><span class="math notranslate nohighlight">\(Z&gt;C\)</span>,认为理论不正确，C取<span class="math notranslate nohighlight">\(\alpha=0.05\)</span>的值</p></li>
<li><p>p-value的概念: 当z取特定值<span class="math notranslate nohighlight">\(z'\)</span>时，比它更不可能出现的总概率</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">## chi2函数</span>
<span class="n">ndf</span><span class="o">=</span><span class="mi">10</span>
<span class="n">rv</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="n">ndf</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">rv</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.001</span><span class="p">),</span><span class="n">rv</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.999</span><span class="p">),</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">ndf</span><span class="p">,</span><span class="n">rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">ndf</span><span class="p">,</span><span class="n">rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">where</span><span class="o">=</span><span class="n">x</span><span class="o">&gt;</span><span class="n">rv</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PolyCollection at 0x16a0d9be0&gt;
</pre></div>
</div>
<img alt="_images/L9_5_1.png" src="_images/L9_5_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## chi2函数</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ndf</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">):</span>
    <span class="n">rv</span><span class="o">=</span><span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="n">ndf</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">ndf</span><span class="p">)</span><span class="o">*</span><span class="n">ndf</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">rv</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">ndf</span><span class="p">)</span><span class="o">*</span><span class="n">ndf</span><span class="p">,</span><span class="n">where</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">ndf</span><span class="o">&gt;</span><span class="n">rv</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">),</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/L9_6_0.png" src="_images/L9_6_0.png" />
</div>
</div>
</section>
<section id="id3">
<h1>拟合优度例子<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h1>
<p>掷骰子,共掷了6x<span class="math notranslate nohighlight">\(10^{10}\)</span>，6个面各自得到的次数为</p>
<p><span class="math notranslate nohighlight">\(10^{10}-10^6,10^{10}+1.5*10^6,10^{10}-2*10^6,10^{10}+4*10^6,10^{10}-3*10^6,10^{10}+0.5*10^6\)</span></p>
<p>筛子各面是否均匀？</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="n">z</span><span class="o">=</span><span class="nb">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3250.0
0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=3250.0, pvalue=0.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">f_exp</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=3250.0, pvalue=0.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">n</span><span class="o">=</span><span class="mi">6</span>
<span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ErrorbarContainer object of 3 artists&gt;
</pre></div>
</div>
<img alt="_images/L9_11_1.png" src="_images/L9_11_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mf">1.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">10</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=32.5, pvalue=4.729328015321194e-06)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=0.325, pvalue=0.99714628722302)
</pre></div>
</div>
<img alt="_images/L9_12_2.png" src="_images/L9_12_2.png" />
</div>
</div>
<ul class="simple">
<li><p>一家工厂分早、中、晚班。最近发生事故早班6，中班3，晚班6。怀疑事故率与时间有关，如何验证/证伪？</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=1.2, pvalue=0.5488116360940265)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Power_divergenceResult(statistic=3.9999999999999996, pvalue=0.13533528323661273)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h1>理论含有未知参数<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h1>
<p>例：民调n个人，认为A赢的有v1,认为B赢的有v2,认为平手的有v3=n-v1-v2人。</p>
<ul class="simple">
<li><p>判断AB的支持率是否相等</p>
<ol class="simple">
<li><p>忽略v3，验证v1,v2是否与p=0.5的假设相符，即[v1,v2]是否与[(v1+v2)/2,(v1+v2)/2]相符</p></li>
<li><p>不忽略v3，那么2人支持率相等的假设对应的概率为 [p,p,1-2p], 验证[v1,v2,v3]与 [np,np,n(1-2p)]相符</p></li>
</ol>
</li>
<li><p>以上两种判断得到的结论是否相同？</p></li>
</ul>
<ul class="simple">
<li><p>第一种</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ N = (v_1+v_2) \]</div>
<div class="math notranslate nohighlight">
\[ Z= [v_1- N/2]^2/(N/2) +  [v_2- N/2]^2/(N/2) = (v_1-v_2)^2/N \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.841458820694124
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.95</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>195.99639845400537
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5098.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.975</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>196.0
</pre></div>
</div>
</div>
</div>
<ul>
<li><p>第二种</p>
<ul class="simple">
<li><p>参数p未知，用最大似然法估计p的最佳值，再进行优度验证</p></li>
<li><p>原本的卡方分布自由度由k-1变为k-r-1,r为未知参数的个数</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ L = C p^{v_1} p ^{v_2} (1-2p)^{v_3}\]</div>
<div class="math notranslate nohighlight">
\[ \frac{\partial L}{\partial p} = (v_1+v_2) p^{v_1+v_2-1}(1-2p)^{v_3} - 2v_3 p^{v_1+v_2}(1-2p)^{v_3} =0\]</div>
<div class="math notranslate nohighlight">
\[(v_1+v_2)/p - 2v_3/(1-2p)=0 \]</div>
<div class="math notranslate nohighlight">
\[ p = (v_1+v_2)/(2n)\]</div>
<div class="math notranslate nohighlight">
\[ np_1 = (v_1+v_2)/2, np_2=(v_1+v_2)/2, np_3 = v_3\]</div>
<div class="math notranslate nohighlight">
\[ Z= (v_1- np)^2/(np) +  (v_2- np)^2/(np) = (v_1-v_2)^2/(v_1+v_2)\]</div>
<ul class="simple">
<li><p>结论与第一种相同</p></li>
</ul>
</li>
</ul>
</section>
<section id="contingency-table">
<h1>对列联表（Contingency Table）<a class="headerlink" href="#contingency-table" title="Permalink to this headline">#</a></h1>
<p>例：判断两个变量（属性）是否独立</p>
<ul class="simple">
<li><p>变量A: 是否接受治疗（是，否）</p></li>
<li><p>变量B: 效果（治愈，有些好转，没有效果）</p></li>
</ul>
<p>研究治疗是否对病人有效，效果与接受治疗是否独立。将数据分为2X3类，检验数据与独立变量的理论是否符合</p>
<ul class="simple">
<li><p>变量A分a类，变量B分b类，数据共被分为axb类</p></li>
<li><p>总样本n个，每类事例数为<span class="math notranslate nohighlight">\(n_{ij}\)</span>个</p></li>
<li><p>理论：对A落入第i个类别的概率<span class="math notranslate nohighlight">\(u_i\)</span>, 对B落入第j个类别的概率为<span class="math notranslate nohighlight">\(v_j\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \sum_{i=1}^{a} u_i =1 , \sum_{i=1}^{b} v_i =1 \]</div>
<ul class="simple">
<li><p>若AB独立，则落入第ij个类别的概率为</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ p_{ij} = u_i v_j\]</div>
<ul class="simple">
<li><p>检验所有类别的数据与该假设是否符合</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ Z = \sum_i \sum_j (n_{ij}- np_{ij})^2 /(np_{ij}) \]</div>
<ul class="simple">
<li><p>Z的自由度为 ab - 1 - (a-1) - (b-1) = (a-1)(b-1)</p></li>
</ul>
<ul class="simple">
<li><p>求<span class="math notranslate nohighlight">\(u_i\)</span>和<span class="math notranslate nohighlight">\(v_i\)</span>的最大似然估计</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ L = \Pi_{i}\Pi_{j} (u_i v_j)^{n_{ij}} \]</div>
<div class="math notranslate nohighlight">
\[ \ln L = \sum_{i,j} n_{ij}(\ln {u_i}+\ln {v_j}) \]</div>
<div class="math notranslate nohighlight">
\[ u_a = 1-\sum_{i=1}^{a-1} u_i\]</div>
<div class="math notranslate nohighlight">
\[ \frac{\partial \ln L}{\partial u_i} = \frac{\sum_j n_{ij}}{u_i} - \frac{\sum_j n_{aj}}{u_a} =0\]</div>
<div class="math notranslate nohighlight">
\[ n_{i\cdot}== \sum_{j=1}^{a} n_{ij} \]</div>
<div class="math notranslate nohighlight">
\[ \hat{u}_i = n_{i\cdot}/n\ , \hat{v}_i = v_{\cdot i}/n\]</div>
</section>
<section id="id5">
<h1>对列联表例1<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;Arthritis&quot;</span><span class="p">,</span> <span class="s2">&quot;vcd&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    ID Treatment     Sex  Age Improved
0   57   Treated    Male   27     Some
1   46   Treated    Male   29     None
2   77   Treated    Male   30     None
3   17   Treated    Male   32   Marked
4   36   Treated    Male   46   Marked
..  ..       ...     ...  ...      ...
79  32   Placebo  Female   66     None
80  42   Placebo  Female   66     None
81  15   Placebo  Female   66     Some
82  71   Placebo  Female   68     Some
83   1   Placebo  Female   74   Marked

[84 rows x 5 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="s2">&quot;Improved&quot;</span><span class="p">]]</span>
<span class="c1">#sns.jointplot(data=data, x=&quot;Treatment&quot;, y=&quot;Improved&quot;,)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Improved&quot;</span><span class="p">,</span><span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.FacetGrid at 0x16a302160&gt;
</pre></div>
</div>
<img alt="_images/L9_28_1.png" src="_images/L9_28_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">table_orig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Improved   Marked  None  Some
Treatment                    
Placebo         7    29     7
Treated        21    13     7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_crosstab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Treatment&#39;</span><span class="p">],</span> 
                            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Improved&#39;</span><span class="p">],</span>
                                <span class="n">margins</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_crosstab</span><span class="p">)</span>
<span class="n">table2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">data_crosstab</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Improved   Marked  None  Some  All
Treatment                         
Placebo         7    29     7   43
Treated        21    13     7   41
All            28    42    14   84
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">marginal_probabilities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Treatment
Placebo    0.511905
Treated    0.488095
dtype: float64, Improved
Marked    0.333333
None      0.500000
Some      0.166667
dtype: float64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">fittedvalues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Improved      Marked  None      Some
Treatment                           
Placebo    14.333333  21.5  7.166667
Treated    13.666667  20.5  6.833333
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">test_nominal_association</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>df          2
pvalue      0.0014626434089526352
statistic   13.055019852524108
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">table_orig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(13.055019852524108,
 0.0014626434089526504,
 2,
 array([[14.33333333, 21.5       ,  7.16666667],
        [13.66666667, 20.5       ,  6.83333333]]))
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h1>对列联表例2<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>变量A: 收入，高中低三挡</p></li>
<li><p>变量B: 文化支出，高低两档</p></li>
</ul>
<p>研究收入与文化支出是否有关联，将数据归类，共有3x2种归类</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">63</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">60</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">8</span><span class="p">]])</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">test_nominal_association</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A 2x3 contingency table with counts:
[[63. 37. 60.]
 [16. 17.  8.]]
df          2
pvalue      0.02721702421841765
statistic   7.207825222169756
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">st</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7.207825222169757,
 0.027217024218417676,
 2,
 array([[62.88557214, 42.98507463, 54.12935323],
        [16.11442786, 11.01492537, 13.87064677]]))
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By 肖朦<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>